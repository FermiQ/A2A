# a2a.json

## Overview

This file (`a2a.json`) provides a JSON Schema definition for the Agent-to-Agent (A2A) communication protocol when using JSON-RPC. It defines the structure and constraints for various messages, requests, responses, and data objects exchanged between agents. This schema is crucial for validation, ensuring that JSON payloads conform to the A2A protocol specifications, and can also be used to generate data models or documentation.

## Key Components

This JSON Schema defines a set of data structures under its `definitions` property. Key components include:

### JSONRPCMessage
(Base definition for JSON-RPC messages)
- `jsonrpc`: (String, constant "2.0") Specifies the JSON-RPC protocol version.
- `id`: (String/Integer/Null) Unique identifier for the request, used to correlate requests and responses.

### JSONRPCRequest
(Extends JSONRPCMessage for requests)
- `method`: (String) The name of the RPC method to be invoked (e.g., "message/send", "tasks/get").
- `params`: (Object) A structured value holding the parameters for the method.

### JSONRPCResponse
(Union type for responses, can be success or error)
- Encapsulates either a `JSONRPCSuccessResponse` or a `JSONRPCErrorResponse`.

### JSONRPCSuccessResponse
(Extends JSONRPCMessage for successful responses)
- `result`: (Any) The data returned by the invoked RPC method on success. Structure varies by method.

### JSONRPCErrorResponse
(Extends JSONRPCMessage for error responses)
- `error`: (Object, $ref: `#/definitions/JSONRPCError` or specific error types) An object describing the error.

### A2ARequest
(Union type for all supported A2A request messages)
- An `anyOf` schema that can be one of `SendMessageRequest`, `SendStreamingMessageRequest`, `GetTaskRequest`, `CancelTaskRequest`, etc. Each specific request type defines its own `method` name and `params` structure.

### Message
(Defines the structure of a message exchanged between user and agent)
- `messageId`: (String) Unique ID for the message.
- `role`: (String, enum: "agent", "user") Sender's role.
- `parts`: (Array of `Part`) The content of the message.
- `contextId`: (String, optional) Context ID.
- `taskId`: (String, optional) Task ID.
- `kind`: (String, constant: "message") Event type.

### Task
(Defines the structure of a task object)
- `id`: (String) Unique ID for the task.
- `contextId`: (String) Context ID.
- `status`: (`TaskStatus`) Current status of the task.
- `artifacts`: (Array of `Artifact`, optional) Artifacts generated by the task.
- `history`: (Array of `Message`, optional) Message history for the task.
- `kind`: (String, constant: "task") Event type.

### AgentCard
(Defines the structure for an agent's capability card)
- `name`: (String) Agent's name.
- `description`: (String) Agent's description.
- `url`: (String) Agent's base URL.
- `version`: (String) Agent's version.
- `capabilities`: (`AgentCapabilities`) Supported features.
- `skills`: (Array of `AgentSkill`) Agent's skills.
- `securitySchemes`: (Object) Supported security schemes.
- `defaultInputModes`: (Array of String) Default input MIME types.
- `defaultOutputModes`: (Array of String) Default output MIME types.

### Part
(Union type for different content parts within a `Message` or `Artifact`)
- An `anyOf` schema that can be one of `TextPart`, `FilePart`, or `DataPart`.
    - `TextPart`: Contains `text` (String) and `kind` ("text").
    - `FilePart`: Contains `file` (either `FileWithBytes` or `FileWithUri`), `kind` ("file"), and optional `mimeType`, `name`.
    - `DataPart`: Contains `data` (Object) and `kind` ("data").

### A2AError
(Union type for A2A specific errors, extending JSONRPCError)
- An `anyOf` schema that lists various specific error types like `TaskNotFoundError`, `ContentTypeNotSupportedError`, etc. Each error has a specific `code` (Integer) and `message` (String).

## Important Variables/Constants

While JSON Schema doesn't have variables in the programming sense, it defines several constant values, primarily:
- `jsonrpc: "2.0"` in all JSON-RPC messages.
- `method` names for specific requests (e.g., `"message/send"` for `SendMessageRequest`).
- `kind` properties in objects like `Message` (`"message"`), `Task` (`"task"`), `TextPart` (`"text"`) to discriminate object types.
- `code` values for predefined JSON-RPC errors (e.g., -32600 for Invalid Request, -32700 for Parse Error) and A2A-specific errors.

## Usage Examples

This JSON Schema (`a2a.json`) is used by applications in the following ways:

1.  **Validation**:
    An A2A agent (server) can use this schema to validate incoming JSON-RPC requests from a client to ensure they are correctly structured before processing. Similarly, a client can validate responses from an agent.
    ```javascript
    // Example using a JavaScript JSON Schema validator (like ajv)
    // const Ajv = require("ajv");
    // const ajv = new Ajv();
    // const schema = require("./a2a.json"); // Load the schema
    // const validateSendMessage = ajv.compile(schema.definitions.SendMessageRequest);
    //
    // const validRequest = {
    //   jsonrpc: "2.0",
    //   method: "message/send",
    //   id: "req-1",
    //   params: {
    //     message: { /* ... message object ... */ }
    //   }
    // };
    // if (validateSendMessage(validRequest)) {
    //   // process request
    // } else {
    //   // handle validation error
    // }
    ```

2.  **Code Generation**:
    The schema can be used as an input to tools that generate data model classes or TypeScript interfaces for different programming languages. This helps in creating type-safe applications.

3.  **Documentation**:
    It serves as a formal specification for the A2A JSON-RPC protocol, allowing developers to understand the expected data structures.

4.  **Mocking/Testing**:
    During development and testing, this schema can guide the creation of mock requests and responses.

## Dependencies and Interactions

- **JSON Schema Draft 07**: The schema itself is written according to the JSON Schema Draft 07 specification (`"$schema": "http://json-schema.org/draft-07/schema#"`).
- **JSON-RPC 2.0**: The defined messages adhere to the JSON-RPC 2.0 protocol structure for requests, responses, and errors.
- **A2A Protocol**: This schema is a specific implementation detail of the broader A2A communication protocol, providing the JSON representation for it. It complements the gRPC definition (`a2a.proto`) by offering an alternative communication binding.
- **TypeScript Types**: The structures defined in this JSON schema likely correspond closely to TypeScript interfaces used in the A2A reference implementation (if one exists or is being developed), ensuring consistency between the schema and the actual code.
- **Agent Implementations**: Agents implementing the A2A protocol via JSON-RPC must conform to the message structures defined in this schema.
